---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { Image } from "astro:assets";
import { partnerLogos } from '../../data/partnerLogos.js';
---

<BaseLayout title="事業概要" description="むなかた子ども大学の基本情報、沿革、協力パートナーについてご紹介します。2021年の開学以来の歩みと、社会とともに進めるキャリア教育の現在地をご覧ください。">
  <main>
    <section class="hero">
      <div class="hero__container">
        <div class="hero__content">
          <div class="hero__text fade-up">
            <h1 class="hero__title">事業概要</h1>
            <p class="hero__subtitle">Project Outline</p>
          </div>
          <div class="hero__image">
            <Image
              src="/images/backgrounds/img_bg-hero_outline-01.webp"
              alt="事業概要"
              width={600}
              height={400}
              format="webp"
              quality={85}
              loading="eager"
            />
          </div>
        </div>
      </div>
    </section>

    <div class="breadcrumb">
      <div class="breadcrumb__container">
        <nav aria-label="パンくずナビゲーション">
          <ol class="breadcrumb__list">
            <li class="breadcrumb__item">
              <a href="/">ホーム</a>
            </li>
            <li class="breadcrumb__item">
              <a href="/about">むなかた子ども大学について</a>
            </li>
            <li class="breadcrumb__item" aria-current="page">
              事業概要
            </li>
          </ol>
        </nav>
      </div>
    </div>

    <!-- Introduction Section -->
    <section class="introduction">
      <div class="introduction__container">
        <p class="introduction__text">
          宗像市独自のキャリア教育 「むなかた子ども大学」 は、 2021年の開学以来、
          子どもたちが 「本物から学ぶ」「本物を体験する」 機会を年間を通じて提供し、子どもたちが "夢" や "志"を考えるきっかけづくりに取り組んでいます。<br>
          本ページでは、私たちの基本情報・あゆみ・そして協力パートナーをご紹介します。宗像市が社会とともに進めるキャリア教育の広がりと現在地をぜひご覧ください。
        </p>
      </div>
    </section>

    <!-- Navigation Links -->
    <section class="page-nav">
      <div class="page-nav__container">
        <nav class="page-nav__menu">
          <a href="#information" class="page-nav__link">
            <div class="page-nav__arrow"></div>
            <span class="page-nav__text">基本情報</span>
          </a>
          <a href="#history" class="page-nav__link">
            <div class="page-nav__arrow"></div>
            <span class="page-nav__text">沿革</span>
          </a>
          <a href="#partners" class="page-nav__link">
            <div class="page-nav__arrow"></div>
            <span class="page-nav__text">協力パートナー</span>
          </a>
        </nav>
      </div>
    </section>

    <!-- 基本情報 Section -->
    <section id="information" class="content-section">
      <div class="content-section__container">
        <div class="content-section__header fade-up">
          <div class="content-section__english-title">Information</div>
          <div class="content-section__title-wrapper">
            <Image src="/images/ui/icon_subpage-section-title-01.svg" alt="" width={36} height={36} format="svg" loading="lazy" class="content-section__icon" />
            <h2 class="content-section__title">基本情報</h2>
          </div>
        </div>
        
        <div class="information-box fade-up fade-up--delay-1">
          <dl class="information-list">
            <div class="information-item">
              <dt class="information-item__term">事業名</dt>
              <dd class="information-item__description">むなかた子ども大学（Munakata Kids University）</dd>
            </div>
            
            <div class="information-item">
              <dt class="information-item__term">開始</dt>
              <dd class="information-item__description">2021年4月</dd>
            </div>
            
            <div class="information-item">
              <dt class="information-item__term">主催</dt>
              <dd class="information-item__description">
                宗像市教育委員会<br>
                （教育部 教育総務課 地域教育連携室 グローバル人材育成係）
              </dd>
            </div>
            
            <div class="information-item">
              <dt class="information-item__term">所在地</dt>
              <dd class="information-item__description">
                〒811-3436　福岡県宗像市東郷1丁目1-1<br>
                宗像市役所　本館3階
              </dd>
            </div>
            
            <div class="information-item">
              <dt class="information-item__term">活動概要</dt>
              <dd class="information-item__description">
                子どもたちが自身の可能性を広げたり新たな可能性を発見し、興味・関心を深堀りし「志」を育むため、社会総がかりで「本物から学ぶ」「本物を体験する」機会を提供する
              </dd>
            </div>
            
            <div class="information-item">
              <dt class="information-item__term">主な取組</dt>
              <dd class="information-item__description">メインキャンパス／特設講座／子ども大学の日／夏の課外授業</dd>
            </div>
          </dl>
        </div>
      </div>
    </section>

    <!-- 沿革 Section -->
    <section id="history" class="content-section">
      <div class="content-section__container">
        <div class="content-section__header fade-up">
          <div class="content-section__english-title">History</div>
          <div class="content-section__title-wrapper">
            <Image src="/images/ui/icon_subpage-section-title-01.svg" alt="" width={36} height={36} format="svg" loading="lazy" class="content-section__icon" />
            <h2 class="content-section__title">沿革</h2>
          </div>
        </div>
        
        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-item__marker">
              <div class="timeline-item__circle">
                <Image src="/images/ui/mark_muk-white.svg" alt="" width={24} height={24} format="svg" loading="lazy" class="timeline-item__icon" />
              </div>
              <div class="timeline-item__line">
                <div class="timeline-item__line-progress"></div>
              </div>
            </div>
            <div class="timeline-item__content">
              <div class="timeline-bubble">
                <div class="timeline-bubble__text">
                  <h3 class="timeline-bubble__year">2021年度(令和3年度)</h3>
                  <p class="timeline-bubble__description">
                    開学。<br>
                    メインキャンパスを市内在住の小学生を対象として初開催（21講座）。
                  </p>
                </div>
                <div class="timeline-bubble__image">
                  <Image src="/images/content/img_outline_history-01.webp" alt="2021年度 開学" width={240} height={180} format="webp" quality={85} loading="lazy" />
                </div>
              </div>
            </div>
          </div>
          
          <div class="timeline-item">
            <div class="timeline-item__marker">
              <div class="timeline-item__circle">
                <Image src="/images/ui/mark_muk-white.svg" alt="" width={24} height={24} format="svg" loading="lazy" class="timeline-item__icon" />
              </div>
              <div class="timeline-item__line">
                <div class="timeline-item__line-progress"></div>
              </div>
            </div>
            <div class="timeline-item__content">
              <div class="timeline-bubble">
                <div class="timeline-bubble__text">
                  <h3 class="timeline-bubble__year">2022年度(令和4年度)</h3>
                  <p class="timeline-bubble__description">
                    メインキャンパスの対象を市内在住の小・中学生に拡大し、29講座を展開。<br>
                    特設講座（6講座）、<br>
                    むなかた子ども大学の日スタート。
                  </p>
                </div>
                <div class="timeline-bubble__image">
                  <Image src="/images/content/img_course-menu-02.webp" alt="2022年度 拡大・新設" width={240} height={180} format="webp" quality={85} loading="lazy" />
                </div>
              </div>
            </div>
          </div>
          
          <!-- 残り2つのアイテムは後で追加 -->
          <div class="timeline-item">
            <div class="timeline-item__marker">
              <div class="timeline-item__circle">
                <Image src="/images/ui/mark_muk-white.svg" alt="" width={24} height={24} format="svg" loading="lazy" class="timeline-item__icon" />
              </div>
              <div class="timeline-item__line">
                <div class="timeline-item__line-progress"></div>
              </div>
            </div>
            <div class="timeline-item__content">
              <div class="timeline-bubble">
                <div class="timeline-bubble__text">
                  <h3 class="timeline-bubble__year">2023年度(令和5年度)</h3>
                  <p class="timeline-bubble__description">
                    夏の課外授業をむなかた子ども大学事業としてリニューアル（約70講座）。
                  </p>
                </div>
                <div class="timeline-bubble__image">
                  <Image src="/images/content/img_outline_history-03.webp" alt="2023年度 夏の課外授業スタート" width={240} height={180} format="webp" quality={85} loading="lazy" />
                </div>
              </div>
            </div>
          </div>
          
          <div class="timeline-item">
            <div class="timeline-item__marker">
              <div class="timeline-item__circle">
                <Image src="/images/ui/mark_muk-white.svg" alt="" width={24} height={24} format="svg" loading="lazy" class="timeline-item__icon" />
              </div>
            </div>
            <div class="timeline-item__content">
              <div class="timeline-bubble">
                <div class="timeline-bubble__text">
                  <h3 class="timeline-bubble__year">2024年度(令和6年度)</h3>
                  <p class="timeline-bubble__description">
                    メインキャンパス講座数が34に。<br>
                    第13回 キャリア教育推進連携表彰において日本一となる『最優秀賞』受賞。
                  </p>
                </div>
                <div class="timeline-bubble__image">
                  <Image src="/images/content/img_outline_history-04.webp" alt="2024年度 講座数拡大と最優秀賞受賞" width={240} height={180} format="webp" quality={85} loading="lazy" />
                </div>
              </div>
              <p class="timeline-note">※写真は福岡県庁への受賞報告時の写真です</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 協力パートナー Section -->
    <section id="partners" class="content-section">
      <div class="content-section__container">
        <div class="content-section__header fade-up">
          <div class="content-section__english-title">Partners</div>
          <div class="content-section__title-wrapper">
            <Image src="/images/ui/icon_subpage-section-title-01.svg" alt="" width={36} height={36} format="svg" loading="lazy" class="content-section__icon" />
            <h2 class="content-section__title">協力パートナー</h2>
          </div>
        </div>
        
        <div class="partners__slider">
          <div class="partners__slides" data-duration="20" data-duration-sm="35">
            <!-- 第1セット -->
            <div class="partners__slide">
              {partnerLogos.map((logo) => (
                <div class="partner-logo">
                  <img src={logo.logoSrc} alt={logo.alt} class="partner-logo__image" />
                </div>
              ))}
            </div>
            <!-- 第2セット（シームレスループ用） -->
            <div class="partners__slide">
              {partnerLogos.map((logo) => (
                <div class="partner-logo">
                  <img src={logo.logoSrc} alt={logo.alt} class="partner-logo__image" />
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</BaseLayout>

<style lang="scss">
  @import "../../styles/index";

  .hero {
    position: relative;
    padding: rem(80) 0 rem(20);
    background: linear-gradient(to bottom, $background-secondary 0%, $background-primary 70%, $background-primary 100%);
    border-radius: 0 rem(120) 0 0;
    
    @include breakpoint-up(md) {
      padding: 0;
      border-radius: 0 rem(240) 0 0;
    }

    &::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 100%;
      height: 100%;
      background-color: $brand-primary;
      z-index: -1;
    }

    &__container {
      margin: 0 auto;
      padding: 0 0 0 5%;
      overflow: hidden;
      @include breakpoint-up(xl) {
        padding: 0 0 0 rem(50);
      }
    }

    &__content {
      position: relative;
      padding: rem(40) 0 0;

      @include breakpoint-up(md) {
        padding: 0;
        display: flex;
        align-items: stretch;
        gap: rem(60);
      }
    }

    &__text {
      @include breakpoint-up(md) {
        flex: 1;
        padding: rem(120) 0 0;
      }
      @include breakpoint-up(xl) {
        padding: rem(160) 0 0;
      }
    }

    &__title {
      @include font-ja-2l(semibold);
      font-weight: bold;
      color: $text-primary;
      margin: 0 0 rem(8) 0;
      line-height: 1.4;

      @include breakpoint-up(lg) {
        @include font-ja-3l(semibold);
        margin-bottom: rem(12);
      }
    }

    &__subtitle {
      @include font-en-s(semibold);
      color: $text-secondary;
      margin: 0 0 rem(30) 0;
      font-weight: 500;
      letter-spacing: 0.05em;

      @include breakpoint-up(lg) {
        @include font-en-m(semibold);
        margin-bottom: 0;
      }
    }

    &__image {
      aspect-ratio: 16 / 9;
      width: 100%;
      @include breakpoint-up(md) {
        flex: 0 0 auto;
        width: 45%;
        min-height: rem(100);
      }
      @include breakpoint-up(xl) {
        max-width: rem(600);
        min-height: rem(400);
      }

      img,
      :global(img) {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: rem(8) 0 0 rem(8);
        @include breakpoint-up(md) {
          border-radius: 0 rem(240) 0 $radius-l;
        }
        @include breakpoint-up(xl) {
          border-radius: 0 rem(240) 0 $radius-2l;
        }
      }
    }
  }

  .breadcrumb {
    padding: rem(20) 0;
    background: $background-primary;
    @include breakpoint-up(lg) {
      padding: rem(50) 0 rem(20);
    }

    &__container {
      margin: 0 auto;
      padding: 0 0 0 5%;
      @include breakpoint-up(xl) {
        padding: 0 0 0 rem(50);
      }
    }

    &__list {
      display: flex;
      align-items: center;
      gap: rem(8);
      list-style: none;
      margin: 0;
      padding: 0;
      @include font-ja-3s;
    }

    &__item {
      display: flex;
      align-items: center;

      &:not(:last-child)::after {
        content: '>';
        margin-left: rem(8);
        color: $text-secondary;
      }

      a {
        @include font-ja-3s(semibold);
        color: $text-link;
        text-decoration: underline;

        &:hover {
          color: $text-link-hover;
          text-decoration: underline;
        }
      }

      &[aria-current="page"] {
        @include font-ja-3s;
        color: $text-primary;
        font-weight: 500;
      }
    }
  }

  .introduction {
    padding: rem(20) 0 rem(30);
    background: $background-primary;
    @include breakpoint-up(lg) {
      padding: rem(80) 0 rem(30);
    }

    &__container {
      margin: 0 auto;
      padding: 0 5%;
      @include breakpoint-up(xl) {
        padding: 0 rem(50);
      }
    }

    &__text {
      @include font-ja-s;
      color: $text-primary;
      line-height: 1.8;
      margin: 0;
      
      @include breakpoint-up(xl) {
        max-width: rem(1200);
      }
    }
  }

  .page-nav {
    padding: rem(20) 0 0;
    background: $background-primary;

    &__container {
      margin: 0 auto;
      padding: 0 5%;
      @include breakpoint-up(xl) {
        padding: 0 rem(50);
      }
    }

    &__menu {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: rem(10);

      @include breakpoint-up(sm) {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        gap: 0;
      }
    }

    &__link {
      display: flex;
      align-items: center;
      gap: rem(5);
      color: $text-primary;
      text-decoration: none;
      transition: color 0.3s ease;
      padding: rem(6) rem(10);

      @include breakpoint-up(sm) {
        gap: rem(12);
        padding: rem(6) rem(20);
        border-right: 1px solid $border-secondary;
      }

      @include breakpoint-up(xl) {
        padding: rem(6) rem(30);
      }

      &:first-child {
        @include breakpoint-up(sm) {
          padding-left: 0;
        }
      }

      &:last-child {
        border-right: none;
      }

      &:hover {
        color: $brand-secondary;
        text-decoration: none;

        .page-nav__arrow {
          transform: translateY(rem(6)) rotate(45deg);
        }
      }
    }

    &__text {
      @include font-ja-s(semibold);
    }

    &__arrow {
      width: rem(9);
      height: rem(9);
      border-right: 2px solid currentColor;
      border-bottom: 2px solid currentColor;
      transform: rotate(45deg);
      transition: transform 0.3s ease;
      flex-shrink: 0;
      margin-right: rem(3);
    }
  }

  .content-section {
    padding: rem(80) 0 rem(120);
    background: $background-primary;
    @include breakpoint-up(xl) {
      padding: rem(90) 0 rem(160);
    }

    &:nth-child(even) {
      background: $background-secondary;
    }
    
    // 基本情報セクション: background-primary → background-tertiary
    &#information {
      background: linear-gradient(to bottom, $background-primary 0%, $background-tertiary 100%);
      padding-bottom: rem(40);
      @include breakpoint-up(lg) {
        padding-bottom: rem(50);
      }
      @include breakpoint-up(xl) {
        padding-bottom: rem(70);
      }
    }
    
    // 沿革セクション: background-tertiary → background-secondary
    &#history {
      background: linear-gradient(to bottom, $background-tertiary 0%, $background-secondary 100%);
      padding-bottom: rem(40);
      @include breakpoint-up(lg) {
        padding-bottom: rem(50);
      }
      @include breakpoint-up(xl) {
        padding-bottom: rem(70);
      }
    }
    
    // 協力パートナーセクション: background-secondary(0%) → background-primary(30%) → background-primary(100%)
    &#partners {
      background: linear-gradient(to bottom, $background-secondary 0%, $background-primary 30%, $background-primary 100%);
    }

    &__container {
      margin: 0 auto;
      padding: 0 5%;
      overflow: hidden;
      @include breakpoint-up(xl) {
        padding: 0 rem(50);
      }
    }

    &__header {
      position: relative;
      margin-bottom: rem(50);
      margin-right: -5%;
      overflow: hidden;
      @include breakpoint-up(xl) {
        margin-bottom: rem(70);
      }
    }

    &__english-title {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      @include font-en-2l(semibold);
      background: linear-gradient(90deg, rgba($background-accent, 0.3) 0%, rgba($background-accent, 0.7) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      opacity: 0.1;
      z-index: 1;
      pointer-events: none;
      white-space: nowrap;

      @include breakpoint-up(lg) {
        @include font-en-4l(semibold);
        top: rem(-10);
      }
    }

    &__title-wrapper {
      position: relative;
      display: flex;
      align-items: center;
      gap: rem(8);
      z-index: 2;
      margin-top: rem(40);
      
      @include breakpoint-up(lg) {
        margin-top: rem(80);
      }
    }

    &__icon {
      width: rem(24);
      height: rem(24);
      flex-shrink: 0;
      margin-top: rem(2);

      @include breakpoint-up(lg) {
        width: rem(36);
        height: rem(36);
        margin-top: rem(4);
      }
    }

    &__title {
      @include font-ja-l(semibold);
      color: $text-primary;
      margin: 0;
      line-height: 1.4;

      @include breakpoint-up(lg) {
        @include font-ja-2l(semibold);
      }
    }
  }

  .information-box {
    background-color: #ffffff;
    background-image: radial-gradient(circle, #fce3f0 1.5px, transparent 1.5px);
    background-position: 0 0;
    background-size: 13px 13px;
    border-radius: $radius-m;
    padding: rem(20);
    box-shadow: none;
    @include breakpoint-up(md) {
      padding: rem(30);
      max-width: rem(900);
      margin: 0 auto;
    }
    @include breakpoint-up(xl) {
      padding: rem(40);
      border-radius: $radius-l;
    }
  }

  .information-list {
    margin: 0;
    padding: 0;
  }

  .information-item {
    display: flex;
    flex-direction: column;
    padding: rem(20) 0;
    
    @include breakpoint-up(md) {
      flex-direction: row;
      align-items: flex-start;
    }
    
    &:not(:last-child) {
      border-bottom: 1px solid $border-secondary;
    }

    &__term {
      @include font-ja-s(semibold);
      color: $text-primary;
      font-weight: 600;
      margin: 0 0 rem(8) 0;
      flex-shrink: 0;
      
      @include breakpoint-up(md) {
        @include font-ja-s;
        width: rem(120);
        margin: 0 rem(20) 0 0;
      }
      
      @include breakpoint-up(lg) {
        width: rem(140);
        margin-right: rem(30);
      }
    }

    &__description {
      @include font-ja-s;
      padding-left: rem(10);
      color: $text-primary;
      margin: 0;
      line-height: 1.7;
      flex: 1;
      @include breakpoint-up(md) {
        padding-left: 0;
      }
    }
  }

  .timeline {
    position: relative;
    padding: 0;
    @include breakpoint-up(lg) {
      padding: rem(20) 0;
    }
  }

  .timeline-item {
    display: flex;
    margin-bottom: rem(40);
    position: relative;
    
    @include breakpoint-up(md) {
      margin-bottom: rem(50);
    }
    
    @include breakpoint-up(lg) {
      margin-bottom: rem(60);
      justify-content: center;
    }
    
    &:last-child {
      margin-bottom: 0;
      
      .timeline-item__line {
        display: none;
      }
    }
  }

  .timeline-item__marker {
    position: relative;
    flex-shrink: 0;
    width: rem(60);
    display: flex;
    flex-direction: column;
    align-items: center;
    @include breakpoint-up(lg) {
      width: rem(100);
    }
  }

  .timeline-item__circle {
    width: rem(40);
    height: rem(40);
    background-color: #dddddd;
    border-radius: 50%;
    z-index: 2;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.6s ease;
    
    @include breakpoint-up(md) {
      width: rem(50);
      height: rem(50);
    }
    
    &.active {
      background-color: $brand-primary;
      
      .timeline-item__icon {
        opacity: 1;
      }
    }
  }

  .timeline-item__icon {
    width: rem(20);
    height: rem(20);
    opacity: 0;
    transition: opacity 0.6s ease;
    
    @include breakpoint-up(md) {
      width: rem(24);
      height: rem(24);
    }
  }

  .timeline-item__line {
    width: rem(4);
    background-color: #dddddd;
    position: absolute;
    border-radius: rem(2);
    
    // 円の中心から次のアイテムの円の中心まで
    top: rem(20);  // 円の中心位置
    height: calc(100% + rem(40) + rem(20)); // アイテム高さ + margin-bottom + 次の円の中心まで
    
    @include breakpoint-up(md) {
      width: rem(6);
      border-radius: rem(3);
      top: rem(25);  // 円の中心位置（50px/2）
      height: calc(100% + rem(50) + rem(25)); // アイテム高さ + margin-bottom + 次の円の中心まで
    }
    
    @include breakpoint-up(lg) {
      top: rem(25);  // 円の中心位置（50px/2）
      height: calc(100% + rem(60) + rem(25)); // アイテム高さ + margin-bottom + 次の円の中心まで
    }
  }

  .timeline-item__line-progress {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 0%;
    background-color: $brand-primary;
    border-radius: inherit;
    // スクロールベースなのでtransitionは軽めに
    transition: height 0.1s ease-out;
  }

  .timeline-item__content {
    flex: 1;
    margin-left: rem(20);
    @include breakpoint-up(lg) {
      margin-left: rem(30);
      max-width: rem(900);
    }
  }

  .timeline-bubble {
    background: $background-primary;
    border-radius: 0 0 rem(16) rem(16);
    padding: 0;
    position: relative;
    display: flex;
    flex-direction: column;
    
    @include breakpoint-up(md) {
      flex-direction: row;
      align-items: stretch;
      border-radius: 0 rem(16) rem(16) rem(16);
      min-height: rem(260);
    }
    
    @include breakpoint-up(lg) {
      border-radius: 0 rem(20) rem(20) rem(20);
    }

    @include breakpoint-up(xl) {
    }
    
    // 吹き出しの三角形
    &::before {
      content: '';
      position: absolute;
      left: rem(-9);
      top: rem(10);
      width: 0;
      height: 0;
      border-top: rem(10) solid transparent;
      border-bottom: rem(10) solid transparent;
      border-right: rem(10) solid $background-primary;
      z-index: 1;
      @include breakpoint-up(md) {
        top: rem(15);
      }
      
      @include breakpoint-up(lg) {
        left: rem(-11);
        border-top: rem(12) solid transparent;
        border-bottom: rem(12) solid transparent;
        border-right: rem(12) solid $background-primary;
      }
    }
  }

  .timeline-bubble__text {
    flex: 1;
    padding: rem(20);
    
    @include breakpoint-up(md) {
      padding: rem(30);
    }
  }

  .timeline-bubble__year {
    @include font-ja-s(semibold);
    color: $text-secondary;
    margin: 0 0 rem(12) 0;
    @include breakpoint-up(lg) {
      margin-bottom: rem(16);
    }
  }

  .timeline-bubble__description {
    @include font-ja-m(semibold);
    color: $text-primary;
    line-height: 1.7;
    margin: 0;
  }

  .timeline-note {
    @include font-ja-2s(semibold);
    color: $text-primary;
    margin: rem(8) 0 0 0;
    text-align: right;
  }

  .timeline-bubble__image {
    flex-shrink: 0;
    width: 100%;
    aspect-ratio: 4 / 3;
    overflow: hidden;
    border-radius: 0 0 rem(16) rem(16);
    
    @include breakpoint-up(md) {
      width: rem(200);
      border-radius: 0 rem(16) rem(16) 0;
    }
    
    @include breakpoint-up(lg) {
      width: rem(240);
      border-radius: 0 rem(20) rem(20) 0;
    }
    
    img,
    :global(img) {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }

  .partners__slider {
    overflow: hidden;
    position: relative;
    width: 100vw;
    margin-left: calc(-50vw + 50%);
    margin-top: rem(70);
  }

  .partners__slides {
    display: flex;
    width: 200%; // 2セット分の幅
  }
  
  .partners__slide {
    flex-basis: 50%; // 各セットが50%の幅
    display: flex;
    align-items: center;
  }

  .partner-logo {
    height: rem(60);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    padding: 0 rem(20); // 左右に均等な余白
    
    @include breakpoint-up(lg) {
      padding: 0 rem(30); // lg以上は30pxずつの余白
    }

    &__image {
      height: 100%;
      width: auto;
      max-width: rem(200);
      object-fit: contain;
      
      @include breakpoint-up(lg) {
        max-width: rem(240);
      }
    }
  }
</style>

<script>
  // DigiPress式無限ループスライダーを使用

  // パートナーズスライダーの初期化
  document.addEventListener('DOMContentLoaded', function() {
    // DigiPress式無限ループスライダー
    const slides = document.getElementsByClassName('partners__slides');
    
    for (let i = 0; i < slides.length; ++i) {
      const target = slides[i];
      // sm以降はより遅い速度を使用
      const isSmUp = window.innerWidth >= 640;
      const durationAttr = isSmUp ? target.dataset.durationSm : target.dataset.duration;
      const duration = parseInt(durationAttr || target.dataset.duration) * 1000 || 25000;
      const childNum = target.firstElementChild.children.length; // 1つ目のスライド内のロゴ数
      const logoWidth = ((100 / childNum)).toFixed(2);
      
      // CSS変数としてロゴ幅を設定
      target.style.setProperty('--logo-width', `${logoWidth}%`);

      let startTime = 0;
      let elapsed = 0;
      let progress = 0;

      const loop = (currentTime) => {
        if (!startTime) startTime = currentTime;
        
        elapsed = currentTime - startTime;
        progress = elapsed / duration;
        
        if (progress >= 1) {
          // 1周完了、リセット
          progress = 0;
          startTime = currentTime;
        }
        
        // シームレスな移動（50%移動すれば元の位置に戻る）
        const translateX = -(progress * 50);
        target.style.transform = `translateX(${translateX}%)`;
        
        requestAnimationFrame(loop);
      };
      
      requestAnimationFrame(loop);
    }
  
    // スムーススクロール
    // スクロールアニメーション用のIntersection Observer
    const observerOptions = {
      threshold: 0.1, // 要素の10%が見えたら発火
      rootMargin: '0px 0px -50px 0px' // 下から50px余裕を持たせる
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          // 一度表示されたら監視を停止（パフォーマンス向上）
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    // fade-upクラスを持つ全ての要素を監視対象に追加
    const fadeUpElements = document.querySelectorAll('.fade-up');
    fadeUpElements.forEach(element => {
      observer.observe(element);
    });

    const navLinks = document.querySelectorAll('.page-nav__link');
    
    navLinks.forEach(link => {
      link.addEventListener('click', function(e: Event) {
        e.preventDefault();
        
        const target = e.currentTarget as HTMLAnchorElement;
        const href = target.getAttribute('href');
        const targetId = href?.substring(1);
        const targetElement = targetId ? document.getElementById(targetId) : null;
        
        if (targetElement) {
          targetElement.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });
  });
  
  // タイムラインアニメーション
  document.addEventListener('DOMContentLoaded', function() {
    const timelineItems = Array.from(document.querySelectorAll('.timeline-item'));
    const timeline = document.querySelector('.timeline');
    
    if (!timeline || timelineItems.length === 0) return;
    
    function updateTimeline() {
      const scrollTop = window.pageYOffset;
      const windowHeight = window.innerHeight;
      const viewportCenter = scrollTop + windowHeight / 2;
      
      timelineItems.forEach((item, index) => {
        const itemRect = item.getBoundingClientRect();
        const itemTop = scrollTop + itemRect.top;
        const itemHeight = itemRect.height;
        const itemCenter = itemTop + itemHeight / 2;
        
        const lineProgress = item.querySelector('.timeline-item__line-progress') as HTMLElement;
        
        // 次のアイテムがある場合、線のプログレスを計算
        if (index < timelineItems.length - 1 && lineProgress) {
          const nextItem = timelineItems[index + 1];
          if (nextItem) {
            const nextItemRect = nextItem.getBoundingClientRect();
            const nextItemTop = scrollTop + nextItemRect.top;
            const nextItemCenter = nextItemTop + nextItemRect.height / 2;
            
            // スクロール進行度を計算（現在の円の中心を基準点として）
            const progressStart = itemCenter - windowHeight * 0.3;
            const progressEnd = nextItemCenter - windowHeight * 0.3;
            const currentProgress = Math.max(0, Math.min(1, (viewportCenter - progressStart) / (progressEnd - progressStart)));
            
            // 線のプログレスを更新
            lineProgress.style.height = `${currentProgress * 100}%`;
            
            // 線が次の円に到達したら（95%以上進行したら）次の円をアクティブに
            if (currentProgress >= 0.95) {
              const nextCircle = nextItem.querySelector('.timeline-item__circle');
              if (nextCircle) nextCircle.classList.add('active');
            }
          }
        }
      });
    }
    
    // 初期状態で最初の円をアクティブに
    const firstCircle = timelineItems[0]?.querySelector('.timeline-item__circle');
    if (firstCircle) firstCircle.classList.add('active');
    
    // スクロールイベントリスナー（パフォーマンス考慮でthrottle）
    let ticking = false;
    function onScroll() {
      if (!ticking) {
        requestAnimationFrame(() => {
          updateTimeline();
          ticking = false;
        });
        ticking = true;
      }
    }
    
    window.addEventListener('scroll', onScroll);
    updateTimeline(); // 初期実行
  });
</script>